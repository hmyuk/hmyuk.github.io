---
layout: single
title:  "[Spring] 3. ApplicationContext와 다양한 빈 설정 방법"
author_profile: false
categories: spring
toc: true
sidebar:
  nav: docs






---

## 순서

>1. IOC 컨테이너와 빈
>2. @Mock 가짜 객체를 이용하여 Junit 테스트
>3. ApplicationContext와 다양한 빈 설정 방법
>4. Autowire , Component  Scan
>5. 빈의 스코프
>6. Enviroment 프로파일
>7. Enviroment 프로퍼티
>8. MessageSource
>9. ApplicationEventPublisher
>10. ResourceLoader



## (3). ApplicationContext와 다양한 빈 설정 방법



### (3-1). XML로 등록하는 방법

Bean을 고전적으로  xml에서 등록하는 방법입니다.

- XML

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="empService" class="com.example.applicationcontext.EmpService">
        <property name="empRepository" ref="empRepository"/>
    </bean>

    <bean id="empRepository" class="com.example.applicationcontext.EmpRepository"/>

</beans>
```



- Main Class

```java
public class ApplicationContextApplication {

    public static void main(String[] args) {
        ApplicationContext context = new ClassPathXmlApplicationContext("application.xml");
        String[] beanDefinitionNames = context.getBeanDefinitionNames();

        System.out.println(Arrays.toString(beanDefinitionNames));

        EmpService empService = (EmpService) context.getBean("empService");
        System.out.println(empService.empRepository != null);

    }
}
```



### (3-2) component-scan

Bean을 component-scan과 annotaion으로 등록 하는 방법 입니다.

- XML

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd">
    
   <context:component-scan base-package="com.example.applicationcontext"/>

</beans>
```

- Java 

```java
@Repository
public class EmpRepository {
}

@Service
public class EmpService {

    @Autowired
    EmpRepository empRepository;

    public void setEmpRepository(EmpRepository empRepository) {
        this.empRepository = empRepository;
    }

}

public class ApplicationContextApplication {

    public static void main(String[] args) {
        ApplicationContext context = new ClassPathXmlApplicationContext("application.xml");
        String[] beanDefinitionNames = context.getBeanDefinitionNames();

        System.out.println(Arrays.toString(beanDefinitionNames));

        EmpService empService = (EmpService) context.getBean("empService");
        System.out.println(empService.empRepository != null);

    }

}
```



### (3-3) Java에서 등록하는 방법 

Config에서 의존성 주입을 하지 않고 Bean 만 등록한 다음 @Autowired로 주입하여도 정상적으로 사용 할 수 있습니다.

- Config 

```java
@Configuration
public class ApplicationConfig {
    @Bean
    public EmpRepository empRepository(){
        return new EmpRepository();
    }

    @Bean
    public EmpService empService(){
        EmpService empService = new EmpService();
        empService.setEmpRepository(empRepository());
        return empService;
    }
}
```



- Main Class

```java
public class ApplicationContextApplication {

    public static void main(String[] args) {
//        ApplicationContext context = new ClassPathXmlApplicationContext("application.xml");
        ApplicationContext context = new AnnotationConfigApplicationContext(ApplicationConfig.class);

        String[] beanDefinitionNames = context.getBeanDefinitionNames();

        System.out.println(Arrays.toString(beanDefinitionNames));

        EmpService empService = (EmpService) context.getBean("empService");
        System.out.println(empService.empRepository != null);
    }
}
```



### (3-4) Java에서 commponent Scan 하는 방법

@CommponentScan annotaion을 통하여 scan할 수 있습니다.

- Config 

```java
@Configuration
@ComponentScan(basePackageClasses = ApplicationContextApplication.class)
public class ApplicationConfig {

}
```



### (3-5) Spring boot 의 Scan

spring boot의 @SpringBootApplication annotaion에 컴포넌트 스켄이 포함되어 있어 Application Main Class에 annotation을 붙여 주기만 하면 된다.

- Java

```java
@SpringBootApplication
public class ApplicationContextApplication {

    public static void main(String[] args) {
        SpringApplication.run(ApplicationContextApplication.class, args);
    }
}
```



### (3-6) 다른 package componentScan 하는 방법

다른 패키지를 componentScan 하고자 할 경우, Main Class에 추가하지 말고 Config 파일을 따로 추가하고 진행해야 합니다.  
Main클래스에 @ComponentScan을 추가 할 경우 , 해당 Main 클래스를 기준으로 Commponent 스캔이 되지 않습니다.  
Main에 추가하려면 배열로 하여 해당 main클래스도 추가해 줘야 합니다.

- Config 파일을 분리하여 OrgRepository 추가하는방법

```java
@Configuration
@ComponentScan(basePackages = "com.example.applicationcontext2")
public class ApplicationConfig {
}
```

- Main에서 추가하는 방법

```java
@SpringBootApplication
@ComponentScan(basePackages = {"com.example.applicationcontext", "com.example.applicationcontext2"} )
public class ApplicationContextApplication {

    public static void main(String[] args) {

        SpringApplication application = new SpringApplication(ApplicationContextApplication.class);
        application.run(args);

        ApplicationContext context = new AnnotationConfigApplicationContext();
    }
}

```













